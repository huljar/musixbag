% Extension for MusiXTeX - Bagpipe Macros
%
% This file contains macros for some very common notations in bagpipe music,
% like grace notes and embellishments. In addition to generic macros for grace
% notes or doublings, the most common ones (like high G grace notes, D throws,
% etc.) have shortcut macros defined to facilitate very quick and easy usage.
%
% All macros use \tinynotesize and temporarily decrease \noteskip. They are
% written as 32nd notes (3 beams or flags).
%
\makeatletter
\newdimen\@spacecache

\def\startembellishment{%
    \tinynotesize%
    \@spacecache=\noteskip%
    \noteskip=0.85\@l@mskip}
\def\endembellishment{%
    \normalnotesize%
    \noteskip=\the\@spacecache}

% % % a single arbitrary grace note % % %
\def\gr#1{%
    \startembellishment%
    \cccu{#1}%
    \hqsk%
    \endembellishment}

% % % common grace notes % % %

% High A grace note
\def\grha{%
    \gr o}

% High G grace note
\def\grg{%
    \gr n}

% F grace note
\def\grf{%
    \gr m}

% E grace note
\def\gre{%
    \gr l}

% D grace note
\def\grd{%
    \gr k}

% C grace note
\def\grc{%
    \gr j}

% Low A grace note
\def\gra{%
    \gr h}

% Low G grace note
\def\grlg{%
    \gr g}

% % % Strikes % % %

% Light D Strike
\def\lds{%
    \startembellishment%
    \ibbbu5n{-5}\qb5{nk}\tqu5j%
    \endembellishment}

% Heavy D Strike
\def\hds{%
    \startembellishment%
    \ibbbu5n{-5}\qb5{nk}\tqu5g%
    \endembellishment}

% % % D Throw (light/heavy) % % %
\def\dth{%
    \startembellishment%
    \ibbbu5j2\qb5{gk}\tqu5j%
    \endembellishment}

% % % arbitrary doubling % % %
\def\dbl#1#2#3#4{%
    \startembellishment%
    \ibbbu5{#1}{#4}\qb5{#1#2}\tqu5{#3}%
    \endembellishment}

% % % common doublings % % %

% C doubling
\def\dblc{%
    \dbl njk{-4}}

% D doubling
\def\dbld{%
    \dbl nkl{-3}}

% E doubling
\def\dble{%
    \dbl nlm{-2}}

% F doubling
\def\dblf{%
    \dbl nmn0}

% % % an arbitrary half doubling % % %
\def\hd#1#2#3{%
    \startembellishment%
    \ibbbu5{#1}{#3}\qb5{#1}\tqu5{#2}%
    \endembellishment}

% % % common half doublings % % %

% High A half doubling
\def\hdha{%
    \hd on{-3}}

% E half doubling
\def\hde{%
    \hd lm{3}}

% High G "doubling"
\def\dblg{%
    \hd nm{-3}}

% % % Birls % % %

% "small" birl (to seperate the same note)
\def\birl{%
    \startembellishment%
    \ibbbu5h0\qb5{gh}\tqu5g%
    \endembellishment}

% "full" birl (at the start of the note)
\def\Birl{%
    \startembellishment%
    \ibbbu5h0\qb5{hgh}\tqu5g%
    \endembellishment}

\makeatother
